!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).MP3Tag=e()}(this,(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function o(t,e,r){return(o=s()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&a(i,r.prototype),i}).apply(null,arguments)}function u(t){var e="function"==typeof Map?new Map:void 0;return(u=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return o(t,arguments,i(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)})(t)}function f(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t,e){var r=[];switch(e){case"utf-8":r=function(t){for(var e=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&t.charCodeAt(r)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return e}(t);break;case"utf-16":case"utf-16be":for(var n=new ArrayBuffer(2*t.length),i=new Uint16Array(n),a=new Uint8Array(n),s=0;s<t.length;s++)i[s]=t.charCodeAt(s);r=[255,254],a.forEach((function(t){return r.push(t)}));break;default:for(var o=0;o<t.length;o++)r.push(t.charCodeAt(o))}return r}var v=function(e){function a(){return t(this,a),f(this,i(a).apply(this,arguments))}return n(a,e),r(a,[{key:"getString",value:function(t,e,r){var n=this.getUint8(t,e),i="";switch(r){case"utf-8":i=function(t){var e="",r=0,n=0,i=0,a=0;for(r+=239===t[0]&&187===t[1]&&191===t[2]?3:0;r<t.length;)switch((n=t[r++])>>4){case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(n);break;case 12:case 13:i=t[r++],e+=String.fromCharCode((31&n)<<6|63&i);break;case 14:i=t[r++],a=t[r++],e+=String.fromCharCode((15&n)<<12|(63&i)<<6|(63&a)<<0);break;default:e+=""}return e}(n);break;case"utf-16":case"utf-16be":var a=null;255===n[0]&&254===n[1]?a=!0:254===n[0]&&255===n[1]&&(a=!1),null!==a&&(t+=2,e-=2),i=this.getUint16String(t,e,a);break;default:i=this.getUint8String(t,e)}return i.match(/^[\s\S]+(\0)$/)&&(i=i.substr(0,i.length-1)),i}},{key:"getCString",value:function(t,e){var r,n=[],i=[];i="utf-16"===e||"utf-16be"===e?this.getUint16(t,this.byteLength-t):this.getUint8(t,this.byteLength-t);for(var a=0;a<i.length&&0!==i[a];a++)n.push(i[a]);r=i.BYTES_PER_ELEMENT;var s=n.length*r;return{string:this.getString(t,s,e),length:s+r}}},{key:"getUint8String",value:function(t,e){for(var r=this.getUint8(t,e),n="",i=0;i<r.length;i++){n+=String.fromCharCode(r[i])}return n}},{key:"getUint8CString",value:function(t){for(var e=this.getUint8(t,this.byteLength-t),r="",n=0;n<e.length;n++){var i=e[n];if(0===i)break;r+=String.fromCharCode(i)}return r}},{key:"getUint16String",value:function(t,e){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getUint16(t,e,r),i="",a=0;a<n.length;a++){var s=String.fromCharCode(n[a]);i+=s}return i}},{key:"getUint16CString",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.getUint16(t,this.byteLength-t,e),n="",i=0;i<r.length;i++){var a=r[i];if(0===a)break;var s=String.fromCharCode(a);n+=s}return n}},{key:"getUint8",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t+e,n=new Uint8Array(e),i=0;t<this.byteLength&&t<r;)n[i]=DataView.prototype.getUint8.call(this,t++),i++;return 1===e?n[0]:n}},{key:"getUint16",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t+e,i=new Uint16Array(e/2),a=0;t<this.byteLength&&t<n;)i[a]=DataView.prototype.getUint16.call(this,t,r),t+=2,a++;return 1===e?i[0]:i}}]),a}(u(DataView));function c(t,e){return(t&1<<e)>0}function h(t){for(var e=0,r=2130706432;r;)e>>=1,e|=t&r,r>>=8;return e}function g(t){for(var e=0,r=127;2147483647^r;)e=t&~r,e<<=1,e|=t&r,r=(r+1<<8)-1,t=e;return e}function d(){for(var t=[],e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){e.forEach?e.forEach((function(e){return t.push(e)})):t.push(e)})),new Uint8Array(t)}var p={0:"Unknown error",1:"This format is not yet supported",200:"This file is not an ID3v2",201:"Unsupported ID3v2 major version",202:"Unsupported frame",203:"Frame validation",204:"Frame is not supported in this version of ID3v2"},y=function(e){function a(e){var r;return t(this,a),(r=f(this,i(a).call(this,p[e]))).name="TagError",r.code=e,r.errorId=arguments.length<=1?void 0:arguments[1],r.message=r.parseMessage(),r}return n(a,e),r(a,[{key:"parseMessage",value:function(){var t="";switch(this.code){case 200:t="ID3v2 Error: ".concat(p[this.code]);break;case 201:case 202:case 203:case 204:t="ID3v2 Error: ".concat(p[this.code],' "').concat(this.errorId,'"');break;default:t="".concat(p[this.code])}return t}}]),a}(u(Error));var w=["ascii","utf-16","utf-16be","utf-8"];function m(t){var e=w[t.getUint8(0)];return t.getCString(1,e).string}function b(t){var e=m.call(this,t),r=[];return 3===this.major?r=e.split("/"):4===this.major&&(r=e.split(";")),r}function B(t){var e=m.call(this,t);return e.match(/^(\d+)$/)?parseInt(e):e}function T(t){var e=m.call(this,t);return e.match(/^(\d+)\/(\d+)/)?{position:parseInt(e.split("/")[0]),total:parseInt(e.split("/")[1])}:e}function U(t){return t.getCString(0,"ascii").string}function S(t){var e=w[t.getUint8(0)],r=t.getCString(4,e),n=t.byteLength-r.length-4,i=t.getString(r.length+4,n,e);return{language:t.getString(1,3,"ascii"),descriptor:r.string,text:i}}var j=/^(https?):\/\/[^\s/$.?#]+\.[^\s]*/,A=/^([a-z]{3})$/;function k(t){if("string"!=typeof t)throw new y(203,"ID is not a string");if(!t.match(/^([a-zA-Z0-9]{4})$/))throw new y(203,"ID is invalid");return!0}function C(t,e,r){var n=0;if(t.forEach((function(t){var i=0;r.forEach((function(r){("id"===r&&e[r]===t[r]||"id"!==r&&e.id===t.id&&e.value[r]===t.value[r])&&i++})),n+=i===r.length?1:0})),n>1){var i=r.join(", ");throw new y(203,"There may only 1 ".concat(e.id," with the same ").concat(i))}}function O(t){if(k(t.id),3===this.major&&C(this.frames,t,["id"]),"string"!=typeof t.value)throw new y(203,"".concat(t.id," value is not a string"));return!0}function E(t){if(k(t.id),3===this.major&&C(this.frames,t,["id"]),!Array.isArray(t.value))throw new y(203,"".concat(t.id," value is not an array"));return!0}function I(t){if(k(t.id),3===this.major&&C(this.frames,t,["id"]),"number"!=typeof t.value)throw new y(203,"".concat(t.id," value is not a number"));return!0}function L(t){if(k(t.id),3===this.major&&C(this.frames,t,["id"]),"number"!=typeof t.value.position||"number"!=typeof t.value.total)throw new y(203,"Set frame position/total is not a number");if(t.value.position>t.value.total)throw new y(203,"Position is greater than total");return!0}function P(t){switch(k(t.id),3===this.major&&C(this.frames,t,["id"]),this.major){case 3:if(!t.value.toString().match(/^([0-9]{4})$/))throw new y(203,"Date Frame is not 4 numeric characters long");break;case 4:if("string"!=typeof t.value)throw new y(203,"Time Frames is not a string");if(!t.value.match(/^([0-9]{8})T([0-9]{6})$/))throw new y(203,"Time Frames should follow this format: YYYYMMDD\\THHMMSS");break;default:throw new y(201,this.major)}return!0}function D(t){if(k(t.id),C(this.frames,t,["id"]),!t.value.match(j))throw new y(203,"URL is not a valid URL");return!0}function R(t){if(k(t.id),C(this.frames,t,["language","descriptor"]),t.value.descriptor=t.value.descriptor||"","string"!=typeof t.value.language||"string"!=typeof t.value.descriptor||"string"!=typeof t.value.text)throw new y(203,"Language/descriptor/text is not a string");if(!t.value.language.match(A))throw new y(203,"Language does not follow ISO 639-2");return!0}function x(t,e,r){var n=l(t,"ascii"),i=new v(new ArrayBuffer(4));return 3===r?i.setUint32(0,e):4===r&&i.setUint32(0,g(e)),d(n,i.getUint8(0,4),0,0)}function M(t){var e=0,r=[];switch(this.major){case 3:e=1,r=l(t.value+"\0","utf-16");break;case 4:e=3,r=l(t.value+"\0","utf-8");break;default:throw new y(201,this.major)}return d(x(t.id,r.length+1,this.major),e,r)}function _(t){return t.value=t.value.join("/"),M.call(this,t)}function z(t){var e=l(t.value.toString(),"ascii");return d(x(t.id,e.length+1,this.major),0,e)}function Y(t){return t.value=t.value.position+"/"+t.value.total,M.call(this,t)}function F(t){var e=l(t.value,"ascii");return d(x(t.id,e.length,this.major),e)}function $(t){var e=0,r=l(t.value.language,"ascii"),n=[],i=[];switch(this.major){case 3:e=1,n=l(t.value.descriptor+"\0","utf-16"),i=l(t.value.text,"utf-16");break;case 4:e=3,n=l(t.value.descriptor+"\0","utf-16"),i=l(t.value.text,"utf-16");break;default:throw new y(201,this.major)}var a=n.length+i.length+4;return d(x(t.id,a,this.major),e,r,n,i)}var N={parse:function(t){var e=w[t.getUint8(0)],r=t.getCString(1,"ascii"),n=t.getUint8(r.length+1),i=t.getCString(r.length+2,e),a=t.byteLength-r.length-i.length-2,s=t.getUint8(r.length+i.length+2,a);return{format:r.string,type:n,description:i.string,data:s}},validate:function(t){if(k(t.id),C(this.frames,t,["id","description"]),"string"!=typeof t.value.format||"string"!=typeof t.value.description||"number"!=typeof t.value.type)throw new y(203,"MIME, type, or description is not a string");if("png"!==t.value.format&&"jpeg"!==t.value.format||(t.value.format="image/"+t.value.format),!t.value.format.match(/(image\/[a-z0-9!#$&.+\-^_]+){0,129}/))throw new y(203,"MIME type should be an image");if(t.value.description.length>64)throw new y(203,"Description should not exceed 64");if(!(t.value.data instanceof ArrayBuffer||Array.isArray(t.value.data)||ArrayBuffer.isView(t.value.data)&&!(t.value.data instanceof DataView)))throw new y(203,"Image data should be ArrayBuffer or an array");return!0},getBytes:function(t){var e=0,r=l(t.value.format+"\0","ascii"),n=new Uint8Array(t.value.data),i=[];switch(this.major){case 3:e=1,i=l(t.value.description+"\0","utf-16");break;case 4:e=3,i=l(t.value.description+"\0","utf-8");break;default:throw new y(201,this.major)}var a=r.length+i.length+n.length+2;return d(x(t.id,a,this.major),e,r,t.value.type,i,n)},version:[3,4]},W={parse:S,validate:R,getBytes:$,version:[3,4]},X={parse:m,validate:O,getBytes:M,version:[3,4]},V={parse:B,validate:I,getBytes:z,version:[3,4]},H={parse:b,validate:E,getBytes:_,version:[3,4]},K={parse:m,validate:O,getBytes:M,version:[3,4]},G={parse:m,validate:O,getBytes:M,version:[3,4]},Z={parse:B,validate:P,getBytes:z,version:[3]},q={parse:m,validate:P,getBytes:z,version:[4]},J={parse:B,validate:I,getBytes:z,version:[3]},Q={parse:m,validate:P,getBytes:z,version:[4]},tt={parse:m,validate:P,getBytes:M,version:[4]},et={parse:m,validate:P,getBytes:z,version:[4]},rt={parse:m,validate:P,getBytes:M,version:[4]},nt={parse:m,validate:O,getBytes:M,version:[3,4]},it={parse:b,validate:E,getBytes:_,version:[3,4]},at={parse:m,validate:O,getBytes:M,version:[3,4]},st={parse:B,validate:P,getBytes:z,version:[3]},ot={parse:m,validate:O,getBytes:M,version:[4]},ut={parse:m,validate:O,getBytes:M,version:[3,4]},ft={parse:m,validate:O,getBytes:M,version:[3,4]},lt={parse:m,validate:O,getBytes:M,version:[3,4]},vt={parse:m,validate:function(t){if(k(t.id),3===this.major&&C(this.frames,t,["id"]),"string"!=typeof t.value)throw new y(203,"TKEY is not a string");if(!t.value.match(/^([A-Gb#mo]{3})$/))throw new y(203,"Invalid TKEY Format (e.g. Cbm)");return!0},getBytes:z,version:[3,4]},ct={parse:m,validate:function(t){if(k(t.id),3===this.major&&C(this.frames,t,["id"]),"string"!=typeof t.value)throw new y(203,"TLAN is not a string");if(!t.value.toString().match(/^([a-z]{3})$/))throw new y(203,"Language does not follow ISO 639-2");return!0},getBytes:z,version:[3,4]},ht={parse:B,validate:I,getBytes:z,version:[3,4]},gt={parse:m,validate:O,getBytes:M,version:[3,4]},dt={parse:m,validate:O,getBytes:M,version:[4]},pt={parse:m,validate:O,getBytes:M,version:[3,4]},yt={parse:m,validate:O,getBytes:M,version:[3,4]},wt={parse:b,validate:E,getBytes:_,version:[3,4]},mt={parse:b,validate:E,getBytes:_,version:[3,4]},bt={parse:B,validate:P,getBytes:z,version:[3]},Bt={parse:m,validate:O,getBytes:M,version:[3,4]},Tt={parse:b,validate:E,getBytes:_,version:[3,4]},Ut={parse:m,validate:O,getBytes:M,version:[3,4]},St={parse:m,validate:O,getBytes:M,version:[3,4]},jt={parse:m,validate:O,getBytes:M,version:[3,4]},At={parse:T,validate:L,getBytes:Y,version:[3,4]},kt={parse:m,validate:O,getBytes:M,version:[4]},Ct={parse:m,validate:O,getBytes:M,version:[3,4]},Ot={parse:T,validate:L,getBytes:Y,version:[3,4]},Et={parse:m,validate:O,getBytes:M,version:[3]},It={parse:m,validate:O,getBytes:M,version:[3,4]},Lt={parse:m,validate:O,getBytes:M,version:[3,4]},Pt={parse:B,validate:I,getBytes:z,version:[3]},Dt={parse:m,validate:O,getBytes:M,version:[4]},Rt={parse:m,validate:O,getBytes:M,version:[4]},xt={parse:m,validate:O,getBytes:M,version:[4]},Mt={parse:m,validate:O,getBytes:M,version:[4]},_t={parse:m,validate:function(t){if(k(t.id),3===this.major&&C(this.frames,t,["id"]),"string"!=typeof t.value)throw new y(203,"TSRC is not a string");if(!t.value.match(/^([a-zA-Z0-9]{12})$/))throw new y(203,"Invalid ISRC format");return!0},getBytes:z,version:[3,4]},zt={parse:m,validate:O,getBytes:M,version:[3,4]},Yt={parse:m,validate:O,getBytes:M,version:[4]},Ft={parse:B,validate:P,getBytes:z,version:[3]},$t={parse:function(t){var e=w[t.getUint8(0)],r=t.getCString(1,e),n=t.byteLength-r.length-1,i=t.getString(r.length+1,n,e);return{description:r.string,text:i}},validate:function(t){if(k(t.id),C(this.frames,t,["description"]),"string"!=typeof t.value.description||"string"!=typeof t.value.text)throw new y(203,"User-defined text/description is not a string");return!0},getBytes:function(t){var e=0,r=[],n=[];switch(this.major){case 3:e=1,r=l(t.value.description+"\0","utf-16"),n=l(t.value.text,"utf-16");break;case 4:e=3,r=l(t.value.description+"\0","utf-8"),n=l(t.value.text,"utf-8");break;default:throw new y(201,this.major)}var i=r.length+n.length+1;return d(x(t.id,i,this.major),e,r,n)},version:[3,4]},Nt={parse:S,validate:R,getBytes:$,version:[3,4]},Wt={parse:U,validate:D,getBytes:F,version:[3,4]},Xt={parse:U,validate:D,getBytes:F,version:[3,4]},Vt={parse:U,validate:D,getBytes:F,version:[3,4]},Ht={parse:U,validate:D,getBytes:F,version:[3,4]},Kt={parse:U,validate:D,getBytes:F,version:[3,4]},Gt={parse:U,validate:D,getBytes:F,version:[3,4]},Zt={parse:U,validate:D,getBytes:F,version:[3,4]},qt={parse:U,validate:D,getBytes:F,version:[3,4]},Jt={parse:function(t){var e=w[t.getUint8(0)],r=t.getCString(1,e),n=t.byteLength-r.length-1,i=t.getString(r.length+1,n,"ascii");return{description:r.string,url:i}},validate:function(t){if(k(t.id),C(this.frames,t,["description"]),"string"!=typeof t.value.description||"string"!=typeof t.value.url)throw new y(203,"User-defined text/description is not a string");if(!t.value.url.match(j))throw new y(203,"URL is not a valid URL");return!0},getBytes:function(t){var e=0,r=[],n=[];switch(this.major){case 3:e=1,r=l(t.value.description+"\0","utf-16"),n=l(t.value.text,"ascii");break;case 4:e=3,r=l(t.value.description+"\0","utf-8"),n=l(t.value.text,"ascii");break;default:throw new y(201,this.major)}var i=r.length+n.length+1;return d(x(t.id,i,this.major),e,r,n)},version:[3,4]},Qt=Object.freeze({__proto__:null,APIC:N,COMM:W,TALB:X,TBPM:V,TCOM:H,TCON:K,TCOP:G,TDAT:Z,TDEN:q,TDLY:J,TDOR:Q,TDRC:tt,TDRL:et,TDTG:rt,TENC:nt,TEXT:it,TFLT:at,TIME:st,TIPL:ot,TIT1:ut,TIT2:ft,TIT3:lt,TKEY:vt,TLAN:ct,TLEN:ht,TMED:gt,TMOO:dt,TOAL:pt,TOFN:yt,TOLY:wt,TOPE:mt,TORY:bt,TOWN:Bt,TPE1:Tt,TPE2:Ut,TPE3:St,TPE4:jt,TPOS:At,TPRO:kt,TPUB:Ct,TRCK:Ot,TRDA:Et,TRSN:It,TRSO:Lt,TSIZ:Pt,TSOA:Dt,TSOC:Rt,TSOP:xt,TSOT:Mt,TSRC:_t,TSSE:zt,TSST:Yt,TYER:Ft,TXXX:$t,USLT:Nt,WCOM:Wt,WCOP:Xt,WOAF:Vt,WOAR:Ht,WOAS:Kt,WORS:Gt,WPAY:Zt,WPUB:qt,WXXX:Jt}),te={padding:2048,writer:{version:!1}},ee=function(){function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(this,e),this.buffer=r,this.options=n,this.frames=[]}return r(e,[{key:"options",get:function(){return te},set:function(t){for(var e in te)void 0!==t[e]&&(te[e]=t[e])}}]),r(e,[{key:"read",value:function(){var t=new v(this.buffer);if("ID3"!==t.getUint8String(0,3))throw new y(200);var e=t.getUint8(3,2);switch(e[0]){case 3:case 4:this.major=e[0],this.minor=e[1];break;default:throw new y(201,e[0])}this.size=h(t.getUint32(6)),this.flags=function(t,e){var r={};switch(t){case 3:r.unsynchronisation=c(e,7),r.extendedHeader=c(e,6),r.experimentalIndicator=c(e,5);break;case 4:r.unsynchronisation=c(e,7),r.extendedHeader=c(e,6),r.experimentalIndicator=c(e,5),r.footerPresent=c(e,4);break;default:throw new y(201,t)}return r}(this.major,t.getUint8(5)),this.frames=[];for(var r=10;r<this.size;){var n=t.getUint8(r,this.size),i=re.call(this,n);if(!i)break;this.frames.push(i),r+=i.size+10}return this.frames}},{key:"validate",value:function(){var t=this;return this.frames.forEach((function(e){var r=Qt[e.id];if(!r)throw new y(202,e.id);r.validate.call(t,e)})),!0}},{key:"save",value:function(){if(0===this.frames.length)return this.getAudio();if(!this.validate())return!1;this.major=this.options.writer.version||3,this.minor=0;var t=[73,68,51,this.major,this.minor,32],e=new v(new ArrayBuffer(4)),r=new Uint8Array(this.options.padding),n=this.getAudio(),i=[],a=this;this.frames.forEach((function(t){var e=Qt[t.id];if(!e.version.includes(a.major))throw new y(204,t.id);e.getBytes.call(a,t).forEach((function(t){return i.push(t)}))})),e.setUint32(0,g(i.length+r.length));var s=d(t,e.getUint8(0,4),i,r,n);return this.buffer=s.buffer,this.read(),this.buffer}},{key:"getAudio",value:function(){for(var t=new Uint8Array(this.buffer),e=0;e<t.length;){if(255===t[e]&&251===t[e+1])return new Uint8Array(this.buffer.slice(e));e++}return new Uint8Array(0)}}]),e}();function re(t){var e=new v(t.buffer);if(0===e.getUint8(0))return!1;var r={};if(r.id=e.getUint8String(0,4),3===this.major)r.size=e.getUint32(4);else{if(4!==this.major)throw new y(201,this.major);r.size=h(e.getUint32(4))}r.flags=function(t,e){var r={};switch(t){case 3:r.tagAlterPreservation=c(e[0],7),r.fileAlterPreservation=c(e[0],6),r.readOnly=c(e[0],5),r.compression=c(e[1],7),r.encryption=c(e[1],6),r.groupingIdentity=c(e[1],5);break;case 4:r.tagAlterPreservation=c(e[0],6),r.fileAlterPreservation=c(e[0],5),r.readOnly=c(e[0],4),r.groupingIdentity=c(e[1],6),r.compression=c(e[1],3),r.encryption=c(e[1],2),r.unsynchronisation=c(e[1],1),r.dataLengthIndicator=c(e[1],0);break;default:throw new y(201,t)}return r}(this.major,e.getUint8(8,2));var n=Qt[r.id],i=10,a=r.size,s=r.size,o=[];if(!n)return console.warn("Skipping unsupported frame: ".concat(r.id)),r;if(r.flags.dataLengthIndicator&&(a=h(e.getUint32(i)),i+=4,s-=4),3===this.major&&this.flags.unsynchronisation||4===this.major&&(this.flags.unsynchronisation||r.flags.unsynchronisation)){var u=function(t){for(var e=[],r=0;r<t.length;)e.push(t[r]),255===t[r]&&0===t[r+1]&&r++,r++;return e}(e.getUint8(i,s));o=new ArrayBuffer(a),new Uint8Array(o).set(u)}else o=e.buffer.slice(i,i+a);return r.value=n.parse.call(this,new v(o)),r}var ne={};return function(){function e(r,n){if(t(this,e),r instanceof ArrayBuffer==!1)throw new TypeError("buffer is not an instance of ArrayBuffer");this.buffer=r,this.tagger={},ne=n}return r(e,[{key:"frames",get:function(){return this.tagger.frames},set:function(t){this.tagger.frames=t}}]),r(e,[{key:"read",value:function(){if("ID3"===new v(this.buffer).getUint8String(0,3))this.tagger=new ee(this.buffer,ne),this.tagger.read();else{if(this.tagger=new ee(this.buffer,ne),console.warn("Unknown tag. Getting raw audio data for writing"),!(this.tagger.getAudio().length>0))throw new y(1);this.save()}}},{key:"save",value:function(){this.buffer=this.tagger.save()}},{key:"getBlob",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio/mpeg";return new Blob([this.buffer],{type:t})}}]),e}()}));
